<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Profile – Visuals Only</title>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />
    <style>
      body { background: #f6f7fb; }
      .card { border: 0; box-shadow: 0 10px 25px rgba(0,0,0,.05); }
      .avatar { width: 64px; height: 64px; border-radius: 50%; background: linear-gradient(145deg,#dee2e6,#f8f9fa); display: grid; place-items: center; font-weight: 700; color: #495057; }
      .dirty-dot { width: .6rem; height: .6rem; border-radius: 50%; background: #ffc107; display: inline-block; }
      .input-icon { position: absolute; left: .75rem; top: 50%; transform: translateY(-50%); opacity:.6; }
      .input-with-icon { padding-left: 2rem; }
      .fade-swap-enter { opacity: 0; transform: translateY(2px); }
      .fade-swap-enter-active { opacity: 1; transform: translateY(0); transition: all .2s ease; }
      .fade-swap-exit { opacity: 1; }
      .fade-swap-exit-active { opacity: 0; transition: opacity .15s ease; }
      .strength-bar { height: .4rem; border-radius: .25rem; background: #e9ecef; overflow: hidden; }
      .strength-fill { height: 100%; width: 0%; background: #dc3545; transition: width .25s ease, background-color .25s ease; }
      .offcanvas-w { width: 360px; }
      .sidebar-sticky { position: sticky; top: 1rem; }
    </style>
  </head>
  <body>
    <nav class="navbar navbar-light bg-white border-bottom sticky-top">
      <div class="container-fluid">
        <span class="navbar-brand mb-0 h1">Account</span>
        
      </div>
    </nav>

    <div class="container py-4">
      <div class="row g-4">
        <div class="col-lg-8">
          <div class="card">
            <div class="card-body">
              <div class="d-flex align-items-center mb-3">
                <div class="avatar me-3">MM</div>
                <div>
                  <h5 class="mb-0">Profile</h5>
                  <small class="text-muted">Visuals only – no backend calls here.</small>
                </div>
              </div>

              <!-- Editable Username Row -->
              <div class="mb-3">
                <label for="username" class="form-label">Username</label>
                <div class="position-relative">
                  <svg class="input-icon" width="16" height="16" fill="currentColor" viewBox="0 0 16 16" aria-hidden="true"><path d="M11 1a2 2 0 0 1 2 2v1H3V3a2 2 0 0 1 2-2h6zM3 5h10v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5z"/></svg>
                  <input id="username" class="form-control input-with-icon" type="text" placeholder="your.username" value="max.mustermann" autocomplete="username" aria-describedby="usernameHelp" />
                </div>
                <div class="d-flex align-items-center gap-2 mt-2">
                  <small id="usernameHelp" class="text-muted">Click into the field to edit. Changes are local until you hit <strong>Save</strong>.</small>
                  <span id="dirtyBadge" class="badge rounded-pill text-bg-warning d-none"><span class="dirty-dot me-1"></span>Unsaved</span>
                </div>
              </div>

              <!-- Save / Cancel action bar -->
              <div id="actionBar" class="d-flex gap-2 justify-content-end d-none">
                <button id="cancelBtn" class="btn btn-light">Cancel</button>
                <button id="saveBtn" class="btn btn-primary">
                  <span class="save-label">Save</span>
                  <span class="spinner-border spinner-border-sm align-text-bottom ms-2 d-none" role="status" aria-hidden="true"></span>
                </button>
              </div>

              <hr class="my-4" />

              <!-- Password reset -->
              <div class="d-flex align-items-center justify-content-between">
                <div>
                  <h6 class="mb-1">Password</h6>
                  <small class="text-muted">For security, your password isn't shown. You can reset it below.</small>
                </div>
                <button class="btn btn-outline-danger" data-bs-toggle="modal" data-bs-target="#resetModal">Reset password</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Side: groups & roles offcanvas trigger lives in navbar; add extra info card -->
        <div class="col-lg-4">
          <div class="sidebar-sticky">
            <div class="card mb-4">
              <div class="card-header d-flex align-items-center justify-content-between">
                <h6 class="mb-0">Groups & Roles</h6>
                <span class="badge text-bg-secondary">3</span>
              </div>
              <div class="list-group list-group-flush">
                <div class="list-group-item d-flex justify-content-between align-items-center">
                  Editorial
                  <span class="badge text-bg-primary">Admin</span>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center">
                  Research Team
                  <span class="badge text-bg-info">Moderator</span>
                </div>
                <div class="list-group-item d-flex justify-content-between align-items-center">
                  Alumni Network
                  <span class="badge text-bg-secondary">Member</span>
                </div>
              </div>
              <div class="card-footer"><small class="text-muted">Roles control what you can do in each group.</small></div>
            </div>
            <div class="card">
              <div class="card-body">
                <h6 class="mb-2">Contact email</h6>
                <div class="input-group">
                  <span class="input-group-text" id="email-addon">@</span>
                  <input type="email" class="form-control" aria-describedby="email-addon" value="max@example.com" disabled />
                </div>
                <small class="text-muted">Email changes often require re‑verification.</small>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
      </div>
    </div>

    

    <!-- Modal: reset password -->
    <div class="modal fade" id="resetModal" tabindex="-1" aria-labelledby="resetLabel" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="resetLabel">Reset password</h5>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            <p class="mb-3">Choose how you want to reset:</p>

            <div class="d-grid gap-2 mb-3">
              <button id="sendLinkBtn" class="btn btn-outline-primary">Send reset link to max@example.com</button>
            </div>

            <div class="text-center text-muted mb-2">— or —</div>

            <div class="mb-3">
              <label for="newPw" class="form-label">New password</label>
              <input id="newPw" type="password" class="form-control" placeholder="••••••••" autocomplete="new-password" />
              <div class="strength-bar mt-2" aria-hidden="true"><div id="strengthFill" class="strength-fill"></div></div>
              <small id="pwHint" class="text-muted">Use 12+ chars with a mix of letters, numbers, and symbols.</small>
            </div>
            <div class="mb-3">
              <label for="newPw2" class="form-label">Confirm password</label>
              <input id="newPw2" type="password" class="form-control" placeholder="••••••••" autocomplete="new-password" />
              <div id="matchHelp" class="form-text"></div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-light" data-bs-dismiss="modal">Close</button>
            <button id="updatePwBtn" type="button" class="btn btn-danger" disabled>
              <span class="update-label">Update password</span>
              <span class="spinner-border spinner-border-sm align-text-bottom ms-2 d-none" role="status" aria-hidden="true"></span>
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Toasts -->
    <div class="position-fixed top-0 end-0 p-3" style="z-index: 1080">
      <div id="toastSaved" class="toast align-items-center text-bg-success border-0" role="status" aria-live="polite" aria-atomic="true">
        <div class="d-flex">
          <div class="toast-body">Username saved successfully.</div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
      <div id="toastLink" class="toast align-items-center text-bg-primary border-0 mt-2" role="status" aria-live="polite" aria-atomic="true">
        <div class="d-flex">
          <div class="toast-body">Password reset link sent.</div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
      <div id="toastPw" class="toast align-items-center text-bg-success border-0 mt-2" role="status" aria-live="polite" aria-atomic="true">
        <div class="d-flex">
          <div class="toast-body">Password updated.</div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
      </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
    <script>
      // ===== Visual-only logic (no networking) =====
      const usernameEl = document.getElementById('username');
      const actionBar = document.getElementById('actionBar');
      const dirtyBadge = document.getElementById('dirtyBadge');
      const saveBtn = document.getElementById('saveBtn');
      const cancelBtn = document.getElementById('cancelBtn');
      const saveSpinner = saveBtn.querySelector('.spinner-border');
      const saveLabel = saveBtn.querySelector('.save-label');
      let originalUsername = usernameEl.value;

      function setDirtyState(isDirty){
        actionBar.classList.toggle('d-none', !isDirty);
        dirtyBadge.classList.toggle('d-none', !isDirty);
      }

      usernameEl.addEventListener('input', () => {
        const dirty = usernameEl.value.trim() !== originalUsername.trim();
        setDirtyState(dirty);
      });

      cancelBtn.addEventListener('click', () => {
        usernameEl.value = originalUsername;
        setDirtyState(false);
      });

      function showToast(id){
        const el = document.getElementById(id);
        const t = new bootstrap.Toast(el, { delay: 2200 });
        t.show();
      }

      // Simulated save flow: disable button, show spinner, then toast
      saveBtn.addEventListener('click', () => {
        saveBtn.disabled = true;
        saveSpinner.classList.remove('d-none');
        saveLabel.textContent = 'Saving…';
        // simulate async
        setTimeout(() => {
          originalUsername = usernameEl.value;
          setDirtyState(false);
          saveSpinner.classList.add('d-none');
          saveLabel.textContent = 'Save';
          saveBtn.disabled = false;
          showToast('toastSaved');
        }, 900);
      });

      // ===== Password reset visuals =====
      const sendLinkBtn = document.getElementById('sendLinkBtn');
      const updatePwBtn = document.getElementById('updatePwBtn');
      const updateSpinner = updatePwBtn.querySelector('.spinner-border');
      const updateLabel = updatePwBtn.querySelector('.update-label');
      const newPw = document.getElementById('newPw');
      const newPw2 = document.getElementById('newPw2');
      const matchHelp = document.getElementById('matchHelp');
      const fill = document.getElementById('strengthFill');

      function scorePassword(p){
        let score = 0;
        if (!p) return 0;
        const letters = {};
        for (let i=0; i<p.length; i++) letters[p[i]] = (letters[p[i]]||0) + 1;
        score += Math.min(4, Object.keys(letters).length) * 10;
        score += Math.min(6, p.length) * 5;
        if (/[0-9]/.test(p)) score += 10;
        if (/[a-z]/.test(p) && /[A-Z]/.test(p)) score += 10;
        if (/[^A-Za-z0-9]/.test(p)) score += 10;
        return Math.min(100, score);
      }

      function updateStrength(){
        const s = scorePassword(newPw.value);
        fill.style.width = s + '%';
        fill.style.backgroundColor = s < 40 ? '#dc3545' : s < 70 ? '#fd7e14' : '#198754';
      }

      function validatePw(){
        const ok = newPw.value.length >= 8 && newPw.value === newPw2.value;
        matchHelp.textContent = newPw.value && newPw2.value && newPw.value !== newPw2.value ? 'Passwords do not match.' : '';
        updatePwBtn.disabled = !ok;
      }

      newPw.addEventListener('input', () => { updateStrength(); validatePw(); });
      newPw2.addEventListener('input', validatePw);

      sendLinkBtn.addEventListener('click', () => {
        sendLinkBtn.disabled = true;
        setTimeout(() => { sendLinkBtn.disabled = false; showToast('toastLink'); }, 700);
      });

      updatePwBtn.addEventListener('click', () => {
        updatePwBtn.disabled = true;
        updateSpinner.classList.remove('d-none');
        updateLabel.textContent = 'Updating…';
        setTimeout(() => {
          updateSpinner.classList.add('d-none');
          updateLabel.textContent = 'Update password';
          updatePwBtn.disabled = false;
          newPw.value = '';
          newPw2.value = '';
          fill.style.width = '0%';
          matchHelp.textContent = '';
          showToast('toastPw');
        }, 1000);
      });
    </script>
  </body>
</html>
